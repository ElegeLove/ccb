(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cd62d0a6"],{"7f7ff":function(t,e,a){},"9a69":function(t,e,a){"use strict";var i=a("7f7ff"),n=a.n(i);n.a},ac6a:function(t,e,a){for(var i=a("cadf"),n=a("0d58"),s=a("2aba"),o=a("7726"),l=a("32e9"),c=a("84f2"),r=a("2b4c"),d=r("iterator"),m=r("toStringTag"),u=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=n(h),f=0;f<g.length;f++){var p,y=g[f],x=h[y],S=o[y],_=S&&S.prototype;if(_&&(_[d]||l(_,d,u),_[m]||l(_,m,y),c[y]=u,x))for(p in i)_[p]||s(_,p,i[p],!0)}},b83d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("div",{attrs:{id:"mxPhotoGallery"}},[i("a-form",{staticClass:"mx_form mx_staff",attrs:{layout:"inline"}},[i("a-form-item",{attrs:{label:"食堂："}},[i("a-select",{staticStyle:{width:"150px"},attrs:{value:e.canteenKey},on:{change:e.selectChange}},e._l(e.canteen,function(t,a){return i("a-select-option",{key:a+1},[e._v(e._s(t.title))])}),1)],1)],1),i("a-form",{staticClass:"mx_form",attrs:{layout:"inline"}},[i("a-form-item",{attrs:{label:"日期："}},[i("a-date-picker",{attrs:{disabledDate:e.safetyStartDate,showTime:"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期"},on:{openChange:e.safetyStartOpenChange},model:{value:e.safetyStartValue,callback:function(t){e.safetyStartValue=t},expression:"safetyStartValue"}}),i("div",{staticClass:"mx_divide"},[e._v("—")]),i("a-date-picker",{attrs:{disabledDate:e.safetyEndDate,showTime:"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期",open:e.endOpenSafety},on:{openChange:e.safetyEndOpenChange},model:{value:e.safetyEndValue,callback:function(t){e.safetyEndValue=t},expression:"safetyEndValue"}})],1),i("a-form-item",[i("a-button",{staticClass:"mx_btnbg",attrs:{type:"primary","html-type":"submit"},on:{click:e.mxInquiry}},[e._v("查询")]),i("a-button",{on:{click:e.mxReset}},[e._v("重置")])],1),i("a-form-item",[i("span",{staticClass:"mx_btn"},[i("span",{staticClass:"mx_outPoeration",on:{click:e.mxAllDownload}},[e._v("\n                    批量下载\n                ")])])]),i("a-form-item",[i("span",{staticClass:"mx_btns"},[i("span",{staticClass:"mx_outPoeration",on:{click:e.mxAllDel}},[e._v("\n                    批量删除\n                ")])])])],1),i("ul",{staticClass:"screen"},e._l(e.screenList,function(t,a){return i("li",{class:{activeLi:e.screenId==t.id},on:{click:function(a){return e.mxScreen(t.id)}}},[e._v(e._s(t.text))])}),0),i("a-skeleton",{attrs:{loading:e.loading,active:"",title:!1,paragraph:{rows:20}}},[i("a-checkbox-group",{staticStyle:{width:"100%"},on:{change:e.onChange}},[e.gallery.length>0?i("ul",{staticClass:"mxList"},e._l(e.gallery,function(t,a){return i("li",[i("div",{staticClass:"mxList_pic"},[i("img",{attrs:{src:t.url,alt:""},on:{click:function(t){return e.mxShowPic(a)}}}),i("div",{staticClass:"mx_tabs"},[i("div",[i("a-checkbox",{attrs:{value:a}})],1),i("div",{staticClass:"mx_tabs_icon"},[i("a-icon",{staticStyle:{"margin-right":"6px",cursor:"pointer"},attrs:{type:"download"},on:{click:e.mxDownload}}),i("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"delete"},on:{click:function(a){return e.mxDel(t.attachment_id)}}}),i("a-modal",{attrs:{title:"删除确认",centered:"",maskStyle:{opacity:"0.1",background:"#000",animation:"none"},okText:"确认",cancelText:"取消"},on:{cancel:e.mxSafetyCel,ok:e.mxDelSafetysure},model:{value:e.isDelSafety,callback:function(t){e.isDelSafety=t},expression:"isDelSafety"}},[i("div",{staticClass:"mx_model"},[i("div",{staticClass:"mx_model_mainDel"},[e._v("\n                                            照片删除后无法恢复，是否继续操作？\n                                        ")])])])],1)])]),i("div",{staticClass:"mxList_text"},[i("p",[e._v("食堂："+e._s(t.title))]),i("p",[e._v("来源："+e._s(t.category))]),i("p",[e._v("上传人："+e._s(t.nickname))]),i("p",[e._v("上传时间："+e._s(e.moment(t.created_at).format("YYYY-MM-DD")))])])])}),0):i("p",{staticStyle:{"text-align":"center",marginTop:"30px"}},[e._v("暂未上传照片")]),e.gallery.length>0?i("div",{staticStyle:{position:"relative"}},[i("a-pagination",{staticStyle:{float:"right",margin:"16px 0"},attrs:{total:e.total,pageSize:e.pageSize,current:e.current,showTotal:function(e){return"共 "+t.total+" 条记录 第 "+t.current+" / "+Math.ceil(t.total/t.pageSize)+" 页"},showQuickJumper:""},on:{change:e.onChangeNum}})],1):e._e()])],1),e.isPic?i("div",{staticClass:"mx_pic_show",on:{click:e.mxShowPicCel}},[i("div",{staticClass:"mx_pic_main"},[i("div",{staticClass:"mx_pic_icon"},[i("a-icon",{staticStyle:{"margin-right":"6px",cursor:"pointer"},attrs:{type:"download"},on:{click:e.mxDownload}}),i("a-icon",{staticStyle:{"margin-right":"6px",cursor:"pointer"},attrs:{type:"delete"},on:{click:e.mxDel}}),i("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close"},on:{click:e.mxBtn}})],1),i("a-carousel",{attrs:{arrows:"",dotsClass:"slick-dots slick-thumb"},scopedSlots:e._u([{key:"prevArrow",fn:function(t){return i("div",{staticClass:"custom-slick-arrow"},[i("a-icon",{staticStyle:{left:"10px","font-size":"30px",zIndex:"50",color:"#fff"},attrs:{type:"left-circle"},on:{click:function(){e.imgIdex<0?e.imgIdex=e.gallery.length-1:e.imgIdex-=1}}})],1)}},{key:"nextArrow",fn:function(t){return i("div",{staticClass:"custom-slick-arrow"},[i("a-icon",{staticStyle:{right:"10px","font-size":"30px",zIndex:"50",color:"#fff"},attrs:{type:"right-circle"},on:{click:function(){e.imgIdex==e.gallery.length-e.imgIdex?e.imgIdex=0:e.imgIdex+=1}}})],1)}},{key:"customPaging",fn:function(t){return i("a",{},[i("img",{attrs:{src:e.getImgUrl(t.i)}})])}}],null,!1,3467462209)},e._l(e.gallery,function(t){return i("div",{staticClass:"mx_foot_pic"},[i("img",{attrs:{src:t.url}})])}),0),i("div",{staticClass:"mx_pic_text"},[i("p",[e._v("食堂："+e._s(e.getImgdetail(e.imgIdex).title))]),i("p",[e._v("来源："+e._s(e.getImgdetail(e.imgIdex).category))]),i("p",[e._v("上传人："+e._s(e.getImgdetail(e.imgIdex).nickname))]),i("p",[e._v("上传时间："+e._s(e.moment(e.getImgdetail(e.imgIdex).created_at).format("YYYY-MM-DD")))])])],1)]):e._e()],1)},n=[],s=(a("ac6a"),a("c1df")),o=a.n(s),l="https://raw.githubusercontent.com/vueComponent/ant-design-vue/master/components/vc-slick/assets/img/react-slick/",c={data:function(){var t=this;return{loading:!0,total:60,current:1,pageSize:15,moment:o.a,canteen:[],canteenKey:"全部",canteenId:0,safetyStartValue:null,safetyEndValue:null,endOpenSafety:!1,startTime:"",endTime:"",screenList:[{text:"全部",id:"0"},{text:"陪餐记录",id:"1"},{text:"留样记录",id:"2"},{text:"餐具消毒",id:"3"},{text:"安全巡检",id:"4"},{text:"场地消毒",id:"5"},{text:"防疫记录",id:"6"}],screenId:"0",value:"",imgIdex:"",photoDelId:"",pagination:{pageSize:5,current:1,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["5","10","30"],showSizeChange:function(e,a){return t.pagination.pageSize=a},showTotal:function(e){return"共 ".concat(e," 条记录 第 ").concat(t.pagination.current," / ").concat(Math.ceil(e/t.pagination.pageSize)," 页")}},recordList:[],gallery:[],isDelSafety:!1,isPic:!1,baseUrl:l,top:0}},watch:{safetyStartValue:function(t){t&&(this.startTime=o()(t._d).format("YYYY-MM-DD  HH:mm:ss")),console.log(this.startTime)},safetyEndValue:function(t){t&&(this.endTime=o()(t._d).format("YYYY-MM-DD  HH:mm:ss")),console.log(this.endTime)}},created:function(){this.getGallery("","","",""),this.getCanteen()},methods:{onChangeNum:function(t){this.current=t,this.loading=!0,this.getGallery("","","",""),console.log("Page: ",t)},safetyStartDate:function(t){var e=this.safetyEndValue;return!(!t||!e)&&t.valueOf()>e.valueOf()},safetyEndDate:function(t){var e=this.safetyStartValue;return!(!t||!e)&&e.valueOf()>=t.valueOf()},safetyStartOpenChange:function(t){t||(this.endOpenSafety=!0)},safetyEndOpenChange:function(t){this.endOpenSafety=t},mxInquiry:function(){this.loading=!0,this.getGallery(this.canteenId,this.startTime,this.endTime,this.screenId)},mxReset:function(){this.safetyStartValue=null,this.safetyEndValue=null,this.startTime="",this.endTime="",this.canteenKey=1,this.canteenId=0,this.loading=!0,this.getGallery("","","",this.screenId)},getGallery:function(t,e,a,i){var n=this;this.$get("api/school/safety/photo?page="+this.current+"&canteen_id="+t+"&begin_time="+e+"&end_time="+a+"&category="+i).then(function(t){0==t.data.code?(console.log(t),n.pageSize=t.data.data.per_page,n.total=t.data.data.total,n.gallery=t.data.data.data,n.loading=!1):console.log(22)})},getCanteen:function(){var t=this;this.$get("api/school/canteen",{}).then(function(e){if(0==e.data.code){t.canteen=e.data.data;var a={id:0,title:"全部"};t.canteen.splice(0,0,a)}else console.log(22)})},selectChange:function(t){this.canteenKey=t,this.canteenId=this.canteen[t-1].id},mxScreen:function(t){this.screenId=t,this.current=1,this.loading=!0,this.getGallery(this.canteenId,this.startTime,this.endTime,this.screenId)},onChange:function(t){this.recordList=t},mxDownload:function(){this.$message.success("下载照片成功")},mxAllDownload:function(){this.recordList.length<=0?this.$message.warning("请先选择照片"):this.$message.success("下载照片成功")},mxDel:function(t){this.isDelSafety=!0,this.photoDelId=t},mxSafetyCel:function(){this.isDelSafety=!1},mxDelSafetysure:function(){var t=this;this.isDelSafety=!1;var e={url:"api/school/safety/photo/"+this.photoDelId,method:"delete",data:{}};this.$apiAxiox(e).then(function(e){t.$message.success("删除成功"),t.loading=!0,t.getGallery(t.canteenId,t.startTime,t.endTime,t.screenId)})},mxAllDel:function(){var t=this;if(this.recordList.length<=0)this.$message.warning("请先选择照片");else{var e=[];this.recordList.forEach(function(a){e.push(t.gallery[a].attachment_id)});var a={url:"api/school/safety/photo/"+e.join(","),method:"delete",data:{}};this.$apiAxiox(a).then(function(e){t.$message.success("删除成功"),t.loading=!0,t.getGallery(t.canteenId,t.startTime,t.endTime,t.screenId)})}},mxShowPic:function(t){console.log(t),this.imgIdex=t,this.isPic=!0;var e=document.body;this.isPic?(this.top=window.scrollY,e.style.position="fixed",e.style.top=-this.top+"px"):(e.style.position="",e.style.top="",window.scrollTo(0,this.top))},mxShowPicCel:function(){},mxBtn:function(){this.isPic=!1;var t=document.body;this.isPic?(this.top=window.scrollY,t.style.position="fixed",t.style.top=-this.top+"px"):(t.style.position="",t.style.top="",window.scrollTo(0,this.top))},getImgdetail:function(t){return t<0&&(t=this.gallery.length-1),t>this.gallery.length-1&&(t=0),this.gallery[t]},getImgUrl:function(t){return"".concat(this.gallery[t].url)}}},r=c,d=(a("9a69"),a("2877")),m=Object(d["a"])(r,i,n,!1,null,null,null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-cd62d0a6.dae360bd.js.map