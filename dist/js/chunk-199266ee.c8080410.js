(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-199266ee"],{"06a5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"mx_canteen"}},[a("router-link",{staticClass:"back",attrs:{to:"mx_cMessage"}},[a("a-icon",{attrs:{type:"arrow-left"}}),a("p",[e._v(e._s(e.title))])],1),a("a-skeleton",{attrs:{loading:e.loading,active:"",paragraph:{rows:20}}},[a("a-form",{attrs:{form:e.form}},[a("div",{staticClass:"mx_top",staticStyle:{position:"relative","margin-top":"20px"}},[a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("食堂名称")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceName",{initialValue:e.fRoom.title,rules:[{required:!0,message:"请填写食堂名称"}]}],expression:"[\n                                                'ceName',\n                                                {\n                                                  initialValue: fRoom.title,\n                                                  rules: [\n                                                    { required: true, message: '请填写食堂名称'}\n                                                  ]\n                                                }\n\t\t\t\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"填写食堂名称"}})],1)],1)],1),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("负责人")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lpName",{initialValue:e.fRoom.rName,rules:[{required:!0,message:"请填写负责人姓名"}]}],expression:"[\n                                                'lpName',\n                                                {\n                                                  initialValue: fRoom.rName,\n                                                  rules: [\n                                                    { required: true, message: '请填写负责人姓名'}\n                                                  ]\n                                                }\n\t\t\t\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"填写负责人姓名"}})],1)],1)],1),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("联系方式")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lpPhone",{initialValue:e.fRoom.tel,rules:[{required:!0,message:"请输入正确的手机号",pattern:/^1[3456789]\d{9}$/},{validator:this.handlePhoneCheck}],validateTrigger:["change","blur"]}],expression:"[\n                                            'lpPhone',\n                                            {\n                                              initialValue: fRoom.tel,\n                                              rules: [\n                                              { required: true, message: '请输入正确的手机号', pattern: /^1[3456789]\\d{9}$/ },\n                                              { validator: this.handlePhoneCheck } ], validateTrigger: ['change', 'blur']\n                                            }\n\t\t\t\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"填写联系电话"}})],1)],1)],1),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("食堂详细地址")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceAds",{initialValue:e.fRoom.ads,rules:[{required:!0,message:"请填写食堂详细地址"}]}],expression:"[\n                                    'ceAds',\n                                    {\n                                          initialValue: fRoom.ads,\n                                          rules: [\n                                                { required: true, message: '请填写食堂详细地址'}\n                                          ]\n                                    }\n                                ]"}],attrs:{placeholder:"填写食堂详细地址"}})],1)],1)],1),a("div",{staticClass:"mx_lBox"},[a("p",[e._v("供餐对象选择")]),a("a-form-item",[a("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["etStem",{initialValue:e.fRoom.stateList,rules:[{required:!0,message:"请选择学校学制"}]}],expression:"[\n                                                'etStem',\n                                                {\n                                                    initialValue: fRoom.stateList,\n                                                    rules: [\n                                                        { required: true, message: '请选择学校学制'}\n                                                    ]\n                                                }\n                        ]"}]},[a("a-row",e._l(e.fRoom.list,function(t,i){return a("a-col",{attrs:{span:6},on:{change:function(a){return e.onChange(a,t)}}},[a("a-checkbox",{attrs:{value:t.id}},[e._v(e._s(t.title))])],1)}),1)],1)],1)],1),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("该食堂就餐教师人数")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["pNum",{initialValue:e.fRoom.tNum,rules:[{required:!0,message:"请填教师就餐人数"}]}],expression:"[\n                                    'pNum',\n                                    {\n                                          initialValue: fRoom.tNum,\n                                          rules: [\n                                                { required: true, message: '请填教师就餐人数'}\n                                          ]\n                                    }\n                                ]"}],attrs:{placeholder:"填写教师就餐人数"}})],1)],1)],1),a("div",{staticClass:"Logo"},[a("p",{staticStyle:{width:"130%"}},[e._v("餐饮服务安全等级公示")]),a("div",{staticClass:"img",class:{on:1==e.rEShow}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.fRoom.img,alt:""},on:{click:function(t){return e.handlePreview(e.fRoom.img)}}}),a("a-modal",{on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.previewVisible,callback:function(t){e.previewVisible=t},expression:"previewVisible"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.showUrl,alt:""}})])],1),a("a-form-item",[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["upload",{initialValue:e.fRoom.fileList,rules:[{required:!0,message:"请填上传图片"}],getValueFromEvent:e.normFile}],expression:"['upload', {\n                                initialValue:fRoom.fileList,\n                                rules: [\n                                    { required: true, message: '请填上传图片'}\n                                ],\n                                getValueFromEvent: normFile,\n                            }]"}],staticClass:"mx_right",attrs:{showUploadList:!1,multiple:!0,headers:e.headers,name:"file",action:"http://bate.ccb.micmio.com/api/common/upload"},on:{change:e.upImg}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 上传图片\n                            ")],1)],1)],1)],1)]),a("div",{staticClass:"mx_btn",staticStyle:{position:"relative"}},[a("h2",[e._v("营业执照信息填写")]),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("注册号")]),a("a-form-item",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{initialValue:e.fRoom.code,rules:[{required:!0,message:"请填写营业执照注册号"}]}],expression:"[\n                                    'code',\n                                    {\n                                          initialValue: fRoom.code,\n                                          rules: [\n                                                { required: true, message: '请填写营业执照注册号'}\n                                          ]\n                                    }\n                                ]"}],attrs:{placeholder:"填写营业执照注册号"}})],1)],1)],1),a("div",{staticClass:"mx_txtBox"},[a("p",[e._v("有效起始日期")]),a("a-form-item",[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["rpicker",{initialValue:e.fRoom.timeList},e.rangeConfig],expression:"['rpicker', {initialValue: fRoom.timeList},  rangeConfig]"}]})],1)],1),a("div",{staticClass:"Logo on"},[a("p",{staticStyle:{width:"100%"}},[e._v("证件图片")]),a("div",{staticClass:"img",class:{on:1==e.rEShow2}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.fRoom.img2,alt:""},on:{click:function(t){return e.handlePreview(e.fRoom.img2)}}}),a("a-modal",{on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.previewVisible,callback:function(t){e.previewVisible=t},expression:"previewVisible"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.showUrl,alt:""}})])],1),a("a-form-item",[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["upload2",{initialValue:e.fRoom.fileList2,rules:[{required:!0,message:"请填上传图片"}],getValueFromEvent:e.normFile}],expression:"['upload2', {\n                                initialValue:fRoom.fileList2,\n                                rules: [\n                                    { required: true, message: '请填上传图片'}\n                                ],\n                                getValueFromEvent: normFile,\n                            }]"}],attrs:{name:"file",headers:e.headers,action:"http://bate.ccb.micmio.com/api/common/upload"},on:{change:e.upImg2}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 更换LOGO\n                            ")],1)],1)],1)],1)]),a("a-button",{staticClass:"mx_smBtn",attrs:{type:"primary"},on:{click:e.check}},[e._v(e._s(e.btnName))])],1)],1)],1)},o=[],s=(a("ac6a"),a("8de6")),r=a("bc3a"),n=a.n(r),l=a("4328"),c=a.n(l),m=a("c1df"),d=a.n(m),u={data:function(){return{previewVisible:!1,title:"",form:this.$form.createForm(this),setShow:!1,etStem:!1,rangeConfig:{rules:[{type:"array",required:!0,message:"请选择起始日期"}]},headers:{authorization:"authorization-text"},rErr:!1,rErr2:!1,rEShow:!1,rEShow2:!1,btnName:"立即添加",fRoom:{title:"",rName:"",tel:"",ads:"",list:[],stateList:[],tNum:"",code:"",timeList:[],fileList:[],fileList2:[],sList:[],img:"",img2:""},showUrl:"",loading:!0,foodRoomID:""}},methods:{slnChange:function(e){e.length>=1?(this.etStem=!0,this.setShow=!1):(this.etStem=!1,this.setShow=!0)},handlePhoneCheck:function(e,t,a){a()},check:function(){var e=this,t=["ceName","lpName","lpPhone","ceAds","pNum","code","rpicker","etStem","upload","upload2"];this.form.validateFields(t,function(t,a){if(console.log(a),!t)if(void 0!=e.$route.query.btnName){var i=d()(a.rpicker[0]._d).format("YYYY-MM-DD"),o=d()(a.rpicker[1]._d).format("YYYY-MM-DD");console.log(i,o);var r="";a.etStem.forEach(function(t,a){r+=e.fRoom.list[a].id+","}),r=r.slice(0,r.length-1);var l={title:a.ceName,charge_title:a.lpName,charge_phone:a.lpPhone,loca_detail:a.ceAds,teacher_count:a.pNum,license_no:a.code,supply:r,security:a.upload[0].response.data.id,enclosure:a.upload2[0].response.data.id,issuance:i,term:o};n()({method:"put",url:s["a"].BASE_URL+"api/school/canteen/"+e.foodRoomID,data:c.a.stringify(l),headers:{Authorization:"Bearer "+localStorage.getItem("token"),Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){0==t.data.code&&(e.$message.success("更新成功"),e.$router.push({name:"mx_cMessage"}))}).catch(function(e){})}else{console.log(11111);var m=d()(a.rpicker[0]._d).format("YYYY-MM-DD"),u=d()(a.rpicker[1]._d).format("YYYY-MM-DD"),p="";e.fRoom.list.forEach(function(t,a){1==t.state&&(p+=e.fRoom.list[a].id+",")}),p=p.slice(0,p.length-1);var f={url:"api/school/canteen",method:"post",data:{title:a.ceName,charge_title:a.lpName,charge_phone:a.lpPhone,loca_detail:a.ceAds,teacher_count:a.pNum,license_no:a.code,supply:p,security:a.upload[0].response.data.id,enclosure:a.upload2[0].response.data.id,issuance:m,term:u}};e.$apiAxiox(f).then(function(t){0==t.data.code&&(e.$message.success("添加成功"),e.$router.push({name:"mx_cMessage"}))})}})},upImg:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(this.fRoom.img=e.file.response.data.url,this.$message.success("上传成功")):"error"===e.file.status&&this.$message.error("上传失败")},upImg2:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(this.fRoom.img2=e.file.response.data.url,this.$message.success("上传成功")):"error"===e.file.status&&this.$message.error("上传失败")},normFile:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},onChange:function(e,t){t.state=!t.state,console.log(this.fRoom.list)},handlePreview:function(e){this.showUrl=e,this.previewVisible=!0},handleCancel:function(){this.previewVisible=!1},handleOk:function(){this.previewVisible=!1}},created:function(){var e=this,t=this;if(this.title=this.$route.query.title,this.foodRoomID=this.$route.query.id,void 0!=this.$route.query.btnName)this.btnName=this.$route.query.btnName,n()({method:"get",url:s["a"].BASE_URL+"api/school/canteen/"+this.foodRoomID,data:{},headers:{Authorization:"Bearer "+localStorage.getItem("token"),Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){if(e.fRoom.title=a.data.data.title,e.fRoom.rName=a.data.data.charge_title,e.fRoom.tel=a.data.data.charge_phone,e.fRoom.ads=a.data.data.loca_detail,e.fRoom.tNum=a.data.data.teacher_count,e.fRoom.list=a.data.data.supply_sate,e.fRoom.code=a.data.data.license_no,null!=e.fRoom.list&&e.fRoom.list.forEach(function(t,a){1==t.state&&e.fRoom.stateList.push(t.id)}),console.log(a.data.data.issuance),""!=a.data.data.issuance&&void 0!=a.data.data.issuance?(t.fRoom.timeList.push(d()(1e3*a.data.data.issuance)),t.fRoom.timeList.push(d()(1e3*a.data.data.term))):(t.fRoom.timeList.push(d()(new Date)),t.fRoom.timeList.push(d()(new Date))),""!=a.data.data.enclosure_src){var i={response:{data:{id:a.data.data.enclosure}},status:"done",url:a.data.data.enclosure_src};t.fRoom.img2=a.data.data.enclosure_src,t.fRoom.fileList2.push(i)}if(""!=a.data.data.security_src){var o={response:{data:{id:a.data.data.security}},status:"done",url:a.data.data.security_src};t.fRoom.img=a.data.data.security_src,t.fRoom.fileList.push(o)}e.loading=!1}).catch(function(e){console.log(e)});else{var a={url:"api/school/intelligence",method:"get",data:{}};this.$apiAxiox(a).then(function(t){console.log(t.data.data,"111111"),e.fRoom.list=t.data.data}),setTimeout(function(){e.loading=!1},500)}}},p=u,f=(a("5674"),a("cc88"),a("2877")),h=Object(f["a"])(p,i,o,!1,null,"d9663e5c",null);t["default"]=h.exports},5674:function(e,t,a){"use strict";var i=a("9238"),o=a.n(i);o.a},9238:function(e,t,a){},ac6a:function(e,t,a){for(var i=a("cadf"),o=a("0d58"),s=a("2aba"),r=a("7726"),n=a("32e9"),l=a("84f2"),c=a("2b4c"),m=c("iterator"),d=c("toStringTag"),u=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=o(p),h=0;h<f.length;h++){var g,v=f[h],_=p[v],R=r[v],w=R&&R.prototype;if(w&&(w[m]||n(w,m,u),w[d]||n(w,d,v),l[v]=u,_))for(g in i)w[g]||s(w,g,i[g],!0)}},cc88:function(e,t,a){"use strict";var i=a("d8c8"),o=a.n(i);o.a},d8c8:function(e,t,a){}}]);
//# sourceMappingURL=chunk-199266ee.c8080410.js.map